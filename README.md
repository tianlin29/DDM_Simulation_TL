AThis code is modified base on:
